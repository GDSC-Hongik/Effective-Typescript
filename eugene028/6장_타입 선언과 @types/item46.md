# item46

## 오류의 늪에 빠지게 하는 타입 의존성 관리
강의를 듣거나 타입스크립트를 이용하여 프로젝트를 하다 보면 아래 의문을 심심치 않게 마주칠 수 있다.
![](https://velog.velcdn.com/images/gene028/post/8258186c-38f8-48e8-9b1a-524dd4e2dde8/image.png)

위의 사진은 제로초님이 강의하는 인프런 강의 중 질의응답 페이지에서 많은 따봉을 많이 받은 글이다. `socket`을 사용하게 해 주는 라이브러리의 버전이 현재 진행하고 있는 프로젝트의 ts버전과 맞지 않아서 오류가 발생하는 모양이다.
이렇게 타입스크립트 버전은 개발하는 입장에서 번거롭게 만들 수 있다. 그렇기 때문에 더더욱이 버전과 의존성 관리에 대하여 잘 이해하고 있어야 하며 문제를 빠르게 해결할 수 있는 능력을 가지고 있어야 한다.
아래 세 가지를 고려하면서 개발을 하도록 해 보자..
- 라이브러리의 버전 
- 타입 선언(@types)의 버전
- 타입스크립트의 버전

실제로 나는 마지막인 **타입스크립트의 버전** 때문에 정말 많은 ... 어려움을 겪은 적이 있다. 이제 앞으로는 타입스크립트 의존성 관리에 휘둘리지(?)않을 것이다..

대부분 타입스크립트를 사용하게 된다면 아래와 같은 과정을 겪게 된다.
```
npm install react
```
```
npm install --save-dev @types/react
```
이렇게 설치하게 된다면, **라이브러리와 타입 정보의 버전이 별도로 관리**되는 것이다. 이렇게 버전을 관리하게 되면 마주하게 될 수도 있는 오류를 미리 알아보자.
### 1. 라이브러리를 업데이트 했지만, 실수로 타입 선언은 업데이트하지 않는 경우
이럴 경우 라이브러리의 새로운 기능을 이용하고자 할 때 오류를 마주하게 된다. 이러한 경우, 타입 선언을 업데이트 해주면 되나 아직 타입 선언이 준비가 안되어 있을 수 있다. 이러면 **보강** 기법을 사용하여 사용하려는 새로운 함수와 메서드의 타입 정보를 프로젝트 자체에 추가해주면 된다. 
### 2. 라이브러리보다 타입 선언의 버전이 최신인 경우
내가 아까 예시로 들었던 질문의 경우와 같은 문제이다. 이 때는 타입 선언의 버전을 내리거나, 라이브러리의 버전을 올리면 된다.
### 3. 프로젝트에서 사용하는 타입스크립트 버전보다 라이브러리에서 필요로 하는 타입스크립트 버전이 최신인 경우
이 경우를 내가 가장 많이 겪었던 문제인데...
나는 주로 프로젝트의 타입스크립트 버전을 올리거나/내리는 방식으로 해결했다. 라이브러리의 타입을 변경하는 것도 있겠지만, 이럴 경우 모듈 하나하나 사용하는 것에 대해 타입 선언을 다시 해주거나 사용 잘 하고 있던 함수도 못쓰게 되는 경우도 있었기 때문. 그리고 솔직히 몇버전까지 내려야지 가장 효율적으로 개발할 수 있을 지 감이 잘 안잡힌다. 그래서 자체적으로 타입스크립트 버전을 내리거나 올리는 것이 마음 편했던 것 같다.
### 4. @types의 의존성이 중복될 경우
이럴 경우 걍 node_modules를 쓰지 말자!!! 아님 삭제하고 다시 깔던지.(이걸 안쓰면 애초에 중복되어서 깔릴 경우가 별로 없음) 하지만 내가 마음대로 프로젝트의 패키지를 관리할 수 있는 것이 아니므로.. 
```
npm ls @types/foo
```
를 보아서 폴더 구조를 보고 타입 중복이 발생한 폴더를 찾아본다. 